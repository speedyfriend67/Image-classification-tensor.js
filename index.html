<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Image Classification with TensorFlow.js</title>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.8.0/dist/tf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-converter@3.8.0/dist/tf-converter.min.js"></script>
</head>
<body>
<h1>Image Classification with TensorFlow.js</h1>
<input type="file" id="imageFile" accept="image/*">
<img id="imageElement" src="#" alt="Selected Image" width="224" height="224">
<script>
  // Load the pre-trained MobileNet model
  async function loadModel() {
    const model = await tf.loadGraphModel('https://tfhub.dev/google/imagenet/mobilenet_v2_100_224/feature_vector/4/model.json');
    return model;
  }

  // Classify an image
  async function classifyImage(imageElement) {
    const model = await loadModel();

    // Pre-process the image
    const tfImg = tf.browser.fromPixels(imageElement).resizeNearestNeighbor([224, 224]).toFloat().expandDims();

    // Make prediction
    const predictions = await model.predict(tfImg).data();

    return predictions;
  }

  // Handle image file selection
  const imageFileInput = document.getElementById('imageFile');
  imageFileInput.addEventListener('change', async function(event) {
    const file = event.target.files[0];
    const imgElement = document.getElementById('imageElement');

    // Display selected image
    imgElement.src = URL.createObjectURL(file);

    // Classify image when it's loaded
    imgElement.onload = async function() {
      const predictions = await classifyImage(imgElement);
      console.log(predictions); // Output: array of probabilities for each class
    };
  });
</script>
</body>
</html>
